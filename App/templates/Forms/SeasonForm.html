<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CariFin Data Dashboard ‚Äì Season Management</title>
<link rel="stylesheet" href="Style.css">
</head>
<body>

<!-- TOP BAR -->
<div class="topbar">
  <span>CariFin Data Dashboard</span>
  <div class="topbar-right">
    <span>Hi, Admin123 (Admin)</span>
    <a href="#">System ‚ñæ</a>
    <a href="#">Logout</a>
  </div>
</div>

<!-- PAGE HEADER -->
<div class="page-header">
  <div class="logo-box">üèî</div>
  <div class="breadcrumb"><span>System &rsaquo;</span> Season Management</div>
</div>

<!-- MAIN -->
<div class="main">

  <!-- SECTION TITLE + TOP ACTIONS -->
  <div class="section-title">Manage Seasons</div>
  <div class="section-actions">
    <button class="btn" onclick="openForm('new')">Add New Season</button>
    <button class="btn btn-ghost" onclick="openArchiveModal()">Archive Old Seasons</button>
  </div>

  <!-- REGISTERED INSTITUTIONS TABLE -->
  <div class="card">
    <div class="card-header">Registered Institutions</div>
    <table>
      <thead>
        <tr>
          <th>Year</th>
          <th>Code</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Status</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>2025</strong></td>
          <td><span class="status-dot dot-active"></span> Active</td>
          <td>01-01-2025</td>
          <td>31-12-2025</td>
          <td>
            <span class="badge badge-active">Active</span>
            Urban, Cross Country, City
          </td>
          <td>
            <button class="btn btn-sm" onclick="openForm('edit', 2025)">Edit</button>
            <button class="btn btn-sm btn-ghost" onclick="openForm('clubs', 2025)">Clubs</button>
          </td>
        </tr>
        <tr>
          <td><strong>2024</strong></td>
          <td><span class="status-dot dot-closed"></span> Closed</td>
          <td>01-01-2024</td>
          <td>31-12-2024</td>
          <td>
            <span class="badge badge-closed">Closed</span>
            Urban
          </td>
          <td>
            <button class="btn btn-sm btn-ghost" onclick="openForm('view', 2024)">Re-open</button>
            <button class="btn btn-sm btn-ghost" onclick="openForm('view', 2024)">View</button>
          </td>
        </tr>
        <tr>
          <td><strong>2023</strong></td>
          <td><span class="status-dot dot-closed"></span> Closed</td>
          <td>01-01-2023</td>
          <td>31-12-2023</td>
          <td>
            <span class="badge badge-closed">Closed</span>
            Cross Country, Urban
          </td>
          <td>
            <button class="btn btn-sm btn-ghost" onclick="openForm('view', 2023)">Re-open</button>
            <button class="btn btn-sm btn-ghost" onclick="openForm('view', 2023)">View</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ADD / EDIT SEASON FORM (dashed panel) -->
  <div class="form-panel" id="seasonForm">
    <div class="form-panel-header">
      <span id="formTitle">Add / Edit Season Form</span>
      <button class="close-btn" onclick="closeForm()" title="Close">‚úï</button>
    </div>
    <div class="form-body">

      <!-- Season Year -->
      <div class="form-row">
        <span class="form-label">Season Year:</span>
        <input type="text" class="wide" id="seasonYear" placeholder="e.g. 2026">
      </div>

      <!-- Status -->
      <div class="form-row">
        <span class="form-label">Status:</span>
        <div class="radio-group">
          <label class="radio-option"><input type="radio" name="status" value="active"> Active</label>
          <label class="radio-option"><input type="radio" name="status" value="closed" checked> Closed</label>
          <label class="radio-option"><input type="radio" name="status" value="archived"> Archived</label>
          <label class="radio-option"><input type="radio" name="status" value="planning"> Planning</label>
        </div>
      </div>

      <!-- Date fields -->
      <div class="date-grid">
        <div class="date-field">
          <span class="form-label">Registration Opens:</span>
          <input type="date" id="regOpens">
        </div>
        <div class="date-field">
          <span class="form-label">Closes:</span>
          <input type="date" id="regCloses">
        </div>
        <div class="date-field">
          <span class="form-label">Season Start:</span>
          <input type="date" id="seasonStart">
        </div>
        <div class="date-field">
          <span class="form-label">End:</span>
          <input type="date" id="seasonEnd">
        </div>
      </div>

      <!-- Events -->
      <div class="events-label">Events in this Season:</div>
      <table class="events-table">
        <thead>
          <tr>
            <th>Event</th>
            <th>Included</th>
            <th>Dates</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Urban Challenge 2025</td>
            <td><label><input type="checkbox" checked> Yes</label></td>
            <td><input type="text" placeholder="e.g. Mar 1 ‚Äì Apr 30" value="Mar 1 ‚Äì Apr 30"></td>
          </tr>
          <tr>
            <td>Cross Country 2025</td>
            <td><label><input type="checkbox" checked> Yes</label></td>
            <td><input type="text" placeholder="e.g. Oct 15" value="Oct 15"></td>
          </tr>
          <tr>
            <td>Football Tournament</td>
            <td><label><input type="checkbox"> Yes</label></td>
            <td><input type="text" placeholder="‚Äì"></td>
          </tr>
        </tbody>
      </table>

    </div><!-- /form-body -->

    <!-- FORM ACTIONS -->
    <div class="form-actions">
      <button class="btn" onclick="handleSave()">Save Season</button>
      <button class="btn btn-ghost" onclick="handleActivate()">Activate Season</button>
      <button class="btn btn-ghost" onclick="handlePreview()">Preview Season Dashboard</button>
      <button class="btn btn-ghost btn-danger" style="margin-left:auto" onclick="closeForm()">Cancel</button>
    </div>
  </div>
  <!-- /form-panel -->

</div><!-- /main -->

<!-- ARCHIVE MODAL -->
<div class="overlay" id="archiveOverlay">
  <div class="modal">
    <h3>Archive Old Seasons</h3>
    <p>This will mark all closed seasons prior to the current active year as <strong>Archived</strong>. This action cannot be undone from the dashboard. Continue?</p>
    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeArchiveModal()">Cancel</button>
      <button class="btn" onclick="doArchive()">Confirm Archive</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
  const formPanel = document.getElementById('seasonForm');
  const formTitle = document.getElementById('formTitle');

  const seasonData = {
    2025: { year: '2025', status: 'active', regOpens: '2024-11-01', regCloses: '2024-12-31', start: '2025-01-01', end: '2025-12-31' },
    2024: { year: '2024', status: 'closed', regOpens: '2023-11-01', regCloses: '2023-12-31', start: '2024-01-01', end: '2024-12-31' },
    2023: { year: '2023', status: 'closed', regOpens: '2022-11-01', regCloses: '2022-12-31', start: '2023-01-01', end: '2023-12-31' },
  };

  function openForm(mode, year) {
    formPanel.classList.add('active');

    // Reset
    document.getElementById('seasonYear').value = '';
    document.getElementById('regOpens').value = '';
    document.getElementById('regCloses').value = '';
    document.getElementById('seasonStart').value = '';
    document.getElementById('seasonEnd').value = '';
    document.querySelectorAll('input[name="status"]')[1].checked = true; // default Closed

    if (mode === 'new') {
      formTitle.textContent = 'Add New Season';
    } else if (mode === 'edit' && year) {
      formTitle.textContent = `Edit Season ‚Äì ${year}`;
      const d = seasonData[year];
      if (d) {
        document.getElementById('seasonYear').value = d.year;
        document.querySelectorAll('input[name="status"]').forEach(r => {
          r.checked = r.value === d.status;
        });
        document.getElementById('regOpens').value = d.regOpens;
        document.getElementById('regCloses').value = d.regCloses;
        document.getElementById('seasonStart').value = d.start;
        document.getElementById('seasonEnd').value = d.end;
      }
    } else if (mode === 'view' || mode === 'clubs') {
      formTitle.textContent = `Season ${year} ‚Äì ${mode === 'clubs' ? 'Clubs' : 'View / Re-open'}`;
      const d = seasonData[year];
      if (d) {
        document.getElementById('seasonYear').value = d.year;
        document.querySelectorAll('input[name="status"]').forEach(r => {
          r.checked = r.value === d.status;
        });
        document.getElementById('seasonStart').value = d.start;
        document.getElementById('seasonEnd').value = d.end;
      }
    }

    // Scroll to form
    setTimeout(() => formPanel.scrollIntoView({ behavior: 'smooth', block: 'start' }), 50);
  }

  function closeForm() {
    formPanel.classList.remove('active');
  }

  function handleSave() {
    const yr = document.getElementById('seasonYear').value.trim();
    if (!yr) { showToast('Please enter a Season Year.'); return; }
    showToast(`Season ${yr} saved successfully.`);
  }

  function handleActivate() {
    const yr = document.getElementById('seasonYear').value.trim();
    if (!yr) { showToast('Please enter a Season Year first.'); return; }
    showToast(`Season ${yr} has been activated.`);
  }

  function handlePreview() {
    showToast('Opening Season Dashboard preview‚Ä¶');
  }

  function openArchiveModal() {
    document.getElementById('archiveOverlay').classList.add('active');
  }
  function closeArchiveModal() {
    document.getElementById('archiveOverlay').classList.remove('active');
  }
  function doArchive() {
    closeArchiveModal();
    showToast('Old seasons archived successfully.');
  }

  function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    clearTimeout(t._timer);
    t._timer = setTimeout(() => t.classList.remove('show'), 3000);
  }
</script>
</body>
</html>